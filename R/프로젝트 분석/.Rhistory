plot(diff)
# 단계 3: 로그 적용 - 분산 정상화화
par(mfrow = c(1, 2))
plot(AirPassengers)
log <- diff(log(AirPassengers))
plot(log)
# 실습: 단일 시계열 자료 시각화
# 단계 1: WWWusage 데이터 셋 가져오기
data("WWWusage")
str(WWWusage)
WWWusage
# 단계 2: 시계열 자료 추세선 시각화
# X11()
ts.plot(WWWusage, type = "l", col = "red")
# 실습: 다중 시계열 자료 시각화
# 단계 1: 데이터 가져오기
data(EuStockMarkets)
head(EuStockMarkets)
# 단계 2: 데이터프레임으로 변환
EuStock <- data.frame(EuStockMarkets)
head(EuStock)
# 단계 3: 단일 시계열 자료 추세선 시각화(1,000개 데이터 대상)
X11()
plot(EuStock$DAX[1:1000], type = "l", col = "red")
# 단계 4: 다중 시계열 자료 추세선 시각화(1,000개 데이터 대상)
plot.ts(cbind(EuStock$DAX[1:1000], EuStock$SMI[1:1000]),
main = "주가지수 추세선")
# 실습: 시계열 요소분해 시각화
# 단계 1: 시계열 자료 준비
data <- c(45, 56, 45, 43, 69, 75, 58, 59, 66, 64, 62, 65,
55, 49, 67, 55, 71, 78, 71, 65, 69, 43, 70, 75,
56, 56, 65, 55, 82, 85, 75, 77, 77, 69, 79, 89)
length(data)
# 단계 2: 시계열 자료 생성 - 시계열 자료 형식으로 객체 생성
tsdata <- ts(data, start = c(2016, 1), frequency = 12)
tsdata
# 단계 3: 추세선 확인 - 각 요인(추세, 순환, 계절, 불규칙)을 시각적으로 확인
ts.plot(tsdata)
# 단계 4: 시계열 분해
plot(stl(tsdata, "periodic"))
# 단계 5: 시계열 분해와 변동요인 제거
m <- decompose(tsdata)
attributes(m)
plot(m)
par(mfrow = c(1, 1))
plot(tsdata - m$seasonal)
# 단계 6: 추세요인과 불규칙요인 제거
plot(tsdata - m$trend)
plot(tsdata - m$seasonal - m$trend)
# 실습: 시계열 요소 분해 시각화
# 단계 1: 시계열 자료 생성
input <- c(3180, 3000, 3200, 3100, 3300, 3200,
3400, 3550, 3200, 3400, 3300, 3700)
length(input)
tsdata <- ts(input, start = c(2015, 2), frequency = 12)
# 단계2: 자기 상관 함수 시각화
acf(na.omit(tsdata), main ="자기상관함수", col = "red")
# 단계 3: 부분 자기 상관 함수 시각화
pacf(na.omit(tsdata), main = "부분 자기 상관 함수", col = "red")
# 실습: 시계열 자료의 추세 패턴 찾기 시각화
# 단계 1: 시계열 자료 생성
input <- c(3180, 3000, 3200, 3100, 3300, 3200,
3400, 3550, 3200, 3400, 3300, 3700)
# 단계 2: 추세선 시각화
plot(tsdata, type = "l", col = "red")
# 단계 3: 자기 상관 함수 시각화
acf(na.omit(tsdata), main = "자기 상환함수", col = "red")
# 단계 4: 차분 시각화
plot(diff(tsdata, differences = 1))
# 실습: 이동평균법을 이용한 평활하기
# 단계 1: 시계열 자료 생성
data <- c(45, 56, 45, 43, 69, 75, 58, 59, 66, 64, 62, 65,
55, 49, 67, 55, 71, 78, 71, 65, 69, 43, 70, 75,
56, 56, 65, 55, 82, 85, 75, 77, 77, 69, 79, 89)
length(data)
tsdata <- ts(data, start = c(2016, 1), frequency = 12)
tsdata
# 단계 2: 평화 ㄹ관련 패키지 설치
install.packages("TTR")
library(TTR)
# 단계 3: 이동평균법으로 평활 및 시각화
par(mfrow = c(2, 2))
plot(tsdata, main = "원 시계열 자료")
plot(SMA(tsdata, n = 1), main = "1년 단위 이동평균법으로 평활")
plot(SMA(tsdata, n = 2), main = "2년 단위 이동평균법으로 평활")
plot(SMA(tsdata, n = 3), main = "3년 단위 이동평균법으로 평활")
par(mfrow = c(1, 1))
# 실습: 계절성이 없는 정상성 시계열분석
# 단계 1: 시계열 자료 특성 분석
# 단계 1-1: 데이터 준비
input <- c(3180, 3000, 3200, 3100, 3300, 3200,
3400, 3550, 3200, 3400, 3300, 3700)
# 단계 1-2: 시계열 객체 생성(12개월: 2015 2월 ~ 2016년 1월)
tsdata <- ts(input, start = c(2015, 2), frequency = 12)
tsdata
# 단계 1-3: 추세선 시각화
plot(tsdata, type = "l", col = "red")
# 단계 2: 정상성 시계열 변환
par(mfrow = c(1, 2))
ts.plot(tsdata)
diff <- diff(tsdata)
plot(diff)
# 단계 3: 모형 식별과 추정
install.packages("forecast")
library(forecast)
arima <- auto.arima(tsdata)
arima
# 단계 4: 모형 생성
model <- arima(tsdata, order = c(1, 1, 0))
model
# 단계 5: 모형 진단(모형의 타당성 검정)
# 단계 5-1: 자기 상관 함수에 의한 모형 진단
tsdiag(model)
# 단계 5-2: Box_Ljung에 의한 잔차항 모형 진단
Box.test(model$residuals, lag = 1, type = "Ljung")
# 단계 5-2: Box_Ljung에 의한 잔차항 모형 진단
Box.test(model$residuals, lag = 1, type = "Ljung")
# 단계 6: 미래 예측(업무 적용)
fore <- forecast(model)
fore
par(mfrow = c(1, 2))
plot(fore)
model2 <- forecast(model, h = 6)
plot(model2)
# 실습: 계절성을 갖는 정상성 시계열분석
# 단계 1: 시계열 자로 특성 분석
# 단계 1-1: 데이터 준비
data <- c(55, 56, 45, 43, 69, 75, 58, 59, 66, 64, 62, 65,
55, 49, 67, 55, 71, 78, 61, 65, 69, 53, 70, 75,
56, 56, 65, 55, 68, 80, 65, 67, 77, 69, 79, 82,
57, 55, 63, 60, 68, 70, 58, 65, 70, 55, 65, 70)
length(data)
# 단계 1-2: 시계열 자료 생성
tsdata <- ts(data, start = c(2020, 1), frequency = 12)
tsdata
# 단게 1-3: 시계열 요소 분해 시각화
ts_feature <- stl(tsdata, s.window = "periodic")
plot(ts_feature)
# 단계 2: 정상성 시계열 변환
par(mfrow = c(1, 2))
ts.plot(tsdata)
diff <- diff(tsdata)
plot(diff)
# 단계 3: 모형 식별과 추정
library(forecast)
ts_model2 <- auto.arima(tsdata)
ts_model2
# 단계 4: 모형 생성
model <- arima(tsdata, c(0, 1, 1), seasonal = list(order = c(1, 1, 0)))
# Chapter 15
getwd()
# Chapter 15
getwd()
setwd("C:\Rwork\Lecture")
# Chapter 15
getwd()
setwd("C:\Rwork\R-script")
# Chapter 15
getwd()
# Chapter 15
getwd()
setwd("C:/Rwork/R-script")
# 실습: 단순 선형 회귀분석 수행
# 단계 1: 데이터 가져오기
product <- read.csv("C:/Rwork/Part-III/product.csv", header = TRUE)
str(product)
# 단계 2: 독립변수와 종속벼수 생성
y = product$제품_만족도
x = product$제품_적절성
df <- data.frame(x, y)
# 단계 3: 단순 선형회귀 모델 생성
result.lm <- lm(formula = y ~ x, data = df)
# 단계 4: 회귀분석의 절편과 기울기
result.lm
# 단계 5: 모델의 적합값과 잔차 보기
names(result.lm)
# 단계 5-1: 적합값 보기
fitted.values(result.lm)[1:2]
# 단계 5-2: 관측값 보기
head(df, 1)
# 단계 5-3: 회귀방정식을 적용하여 모델의 적합값 계산
Y = 0.7789 + 0.7393 * 4
Y
# 단계 5-4: 잔차(오차) 계산
3 - 3.735963
# 단계 5-5: 모델의 잔차 보기
residuals(result.lm)[1:2]
# 단계 5-6: 모델의 잔차와 회귀방정식에 의한 적합값으로부터 관측값 계산
-0.7359630 + 3.735963
# 실습: 선형 회귀분석 모델 시각화
# 단계 1: x, y 산점도 그리기
plot(formula = y ~ x, data = product)
# 단계 2: 선형 회귀모델 생성
result.lm <- lm(formula = y ~ x, data = product)
# 단계 5-1: 적합값 보기
fitted.values(result.lm)[1:2]
# 단계 5-2: 관측값 보기
head(df, 1)
# 단계 5-3: 회귀방정식을 적용하여 모델의 적합값 계산
Y = 0.7789 + 0.7393 * 4
Y
# 단계 5-4: 잔차(오차) 계산
3 - 3.735963
# 단계 5-5: 모델의 잔차 보기
residuals(result.lm)[1:2]
# 단계 5-6: 모델의 잔차와 회귀방정식에 의한 적합값으로부터 관측값 계산
-0.7359630 + 3.735963
# 실습: 선형 회귀분석 모델 시각화
# 단계 1: x, y 산점도 그리기
plot(formula = y ~ x, data = product)
# 단계 2: 선형 회귀모델 생성
result.lm <- lm(formula = y ~ x, data = product)
# 단계 2: 선형 회귀모델 생성
result.lm <- lm(formula = y ~ x, data = product)
# 단계 3: 회귀선
abline(result.lm, col = "red")
# Chapter 15
getwd()
# 실습: 단순 선형 회귀분석 수행
# 단계 1: 데이터 가져오기
product <- read.csv("C:/Rwork/Part-III/product.csv", header = TRUE)
str(product)
# 단계 2: 독립변수와 종속벼수 생성
y = product$제품_만족도
x = product$제품_적절성
df <- data.frame(x, y)
# 단계 3: 단순 선형회귀 모델 생성
result.lm <- lm(formula = y ~ x, data = df)
# 단계 4: 회귀분석의 절편과 기울기
result.lm
# 단계 5: 모델의 적합값과 잔차 보기
names(result.lm)
# 단계 5-1: 적합값 보기
fitted.values(result.lm)[1:2]
# 단계 5-2: 관측값 보기
head(df, 1)
# 단계 5-3: 회귀방정식을 적용하여 모델의 적합값 계산
Y = 0.7789 + 0.7393 * 4
Y
# 단계 5-4: 잔차(오차) 계산
3 - 3.735963
# 단계 5-5: 모델의 잔차 보기
residuals(result.lm)[1:2]
# 단계 5-6: 모델의 잔차와 회귀방정식에 의한 적합값으로부터 관측값 계산
-0.7359630 + 3.735963
# 실습: 선형 회귀분석 모델 시각화
# 단계 1: x, y 산점도 그리기
plot(formula = y ~ x, data = product)
# 단계 2: 선형 회귀모델 생성
result.lm <- lm(formula = y ~ x, data = product)
#R 내장 데이터 가져오기
data(iris)
#R 내장 데이터 가져오기
data(iris)
#iris 데이터 확인
str(iris)
#iris : 꽃받침, 꽃잎 데이터 추출
iris
names(iris1)
iris1 <- iris[, -5]
#기술통계량
summary(iris1)
#상관계수
cor(iris1, method="pearson")
#색의 농도로 상관계수
install.packages("corrgram")
library(corrgram)
corrgram(iris1, upper.panel = panel.conf)
#상관계수 챠트
install.packages("PerformanceAnalytics")
library(PerformanceAnalytics)
chart.Correlation(iris1)
#학습데이터와 테스트데이터 분리
1:nrow(iris1)
x <- sample(1:nrow(iris1), 0.7 * nrow(iris1))
train <- iris1[x, ]
test <- iris1[-x, ]
nrow(iris1)
nrow(test)
####회귀모델 : 꽃받침 길이 예측
names(iris1)
#학습
model1 <- lm(formula = Sepal.Length ~  Sepal.Width + Petal.Length + Petal.Width, data=train)
model2 <- lm(formula = Sepal.Length ~  Petal.Length + Petal.Width, data=train)
model3 <- lm(formula = Sepal.Length ~  Sepal.Width + Petal.Length, data=train)
model4 <- lm(formula = Sepal.Length ~  Sepal.Width + Petal.Width, data=train)
#예측
pred1 <- predict(model1, test)
pred2 <- predict(model2, test)
pred3 <- predict(model3, test)
pred4 <- predict(model4, test)
RMSE1 <- sqrt(mean((test$Sepal.Length - pred1)^2))
RMSE2 <- sqrt(mean((test$Sepal.Length - pred2)^2))
RMSE3 <- sqrt(mean((test$Sepal.Length - pred3)^2))
RMSE4 <- sqrt(mean((test$Sepal.Length - pred4)^2))
cat("예측1: ",RMSE1)
cat("예측2: ",RMSE2)
cat("예측3: ",RMSE3)
cat("예측4: ",RMSE4)
#분류모델
library(ggplot2)
ggplot(iris, aes(Sepal.Length, Sepal.Width))  +
geom_point(aes(colour = Species))
ggplot(iris, aes(Petal.Length , Petal.Width))  +
geom_point(aes(colour = Species))
#학습데이터와 테스트데이터 나누기
data(iris)
train <- iris[x, ]
test <- iris[-x, ]
## 경로 설정
getwd()
setwd("C:/Git/Data_analysis/R/프로젝트 분석")
## 군집분석(Clustering)을 위한 패키지 설치
install.packages("cluster")
library(cluster)
### 단계 1: 데이터셋 가져오기
data <- read.csv("상관분석R.csv", header = TRUE)
head(data)
## 필요 칼럼만 호출
# 칼럼 보기
names(data)
# 필요 칼럼만 호출
data <- data[c("평균운행속도", "최고속도", "급가속건수", "급출발건수", "급감속건수", "급좌회전건수") ]
data$평균운행속도 <- as.numeric(data$평균운행속도)
# 데이터 확인
head(data)
### 단계 2: 유클리디안 거리 계산
idist <- dist(data)
head(idist)  ## 평균이 0인 데이터에 대해 오류가 발생
# 단계 3: 계층적 군집분석
hc <- hclust(idist)
hc
# 단계 4: 군집분석 시각화
plot(hc, hang = -1)
# 단계 5: 군집 단위 테두리 생성
rect.hclust(hc, k = 6, border ="red")
summary(idist)
### 단계 3: 비계층적 군집분석
result <- kmeans(data, 3)
names(result)
str(data)
result$cluster
# 변수 간의 상관계수 보기
cor(data, method = "pearson")
### 단계 4: 군집분석 시각화
plot(result, hang = -1)
plot(data$평균운행속도, data$급좌회전건수, col = result$cluster)
### 단계 5: 군집 단위 테두리 생성
rect.hclust(result, k = 1, border ="red")
### 단계 5: 군집 단위 테두리 생성
rect.hclust(result, k = 2, border ="red")
### 단계 4: 군집분석 시각화
plot(result, hang = -1)
plot(data$평균운행속도, data$급좌회전건수, col = result$cluster)
plot(data$평균운행속도, data$급출발건수  , col = result$cluster)
plot(data$평균운행속도, data$급감속건수   , col = result$cluster)
plot(data$평균운행속도, data$급좌회전건수   , col = result$cluster)
plot(data$평균운행속도, data$최고속도   , col = result$cluster)
plot(data$평균운행속도, data$급가속건   , col = result$cluster)
plot(data$평균운행속도, data$급가속건수   , col = result$cluster)
## 필요 칼럼만 호출
# 칼럼 보기
names(data)
### 단계 1: 데이터셋 가져오기
data <- read.csv("상관분석R.csv", header = TRUE)
head(data)
## 필요 칼럼만 호출
# 칼럼 보기
names(data)
# 필요 칼럼만 호출
data <- data[c("평균운행속도", "최고속도", "급가속건수", "급출발건수", "급감속건수", "급좌회전건수") ]
# 필요 칼럼만 호출
data <- data[c("평균운행속도", "최고속도", "급가속건수",
"급출발건수", "급감속건수",  "급정지건수",
"급좌회전건수", "급우회전건수", "급유턴건수",
"급앞지르기건수", "급진로변경건수"  ) ]
### 단계 1: 데이터셋 가져오기
data <- read.csv("상관분석R.csv", header = TRUE)
head(data)
## 필요 칼럼만 호출
# 칼럼 보기
names(data)
# 필요 칼럼만 호출
data <- data[c("평균운행속도", "최고속도", "급가속건수",
"급출발건수", "급감속건수",  "급정지건수",
"급좌회전건수", "급우회전건수", "급유턴건수",
"급앞지르기건수", "급진로변경건수") ]
data$평균운행속도 <- as.numeric(data$평균운행속도)
# 데이터 확인
head(data)
### 단계 2: 유클리디안 거리 계산
idist <- dist(data)
head(idist)  ## 평균이 0인 데이터에 대해 오류가 발생
# 단계 3: 계층적 군집분석
hc <- hclust(idist)
hc
# 단계 4: 군집분석 시각화
plot(hc, hang = -1)
# 단계 5: 군집 단위 테두리 생성
rect.hclust(hc, k = 6, border ="red")
summary(idist)
str(data)
data$평균운행속도 <- as.numeric(data$평균운행속도)
# 데이터 확인
head(data)
### 단계 2: 유클리디안 거리 계산
idist <- dist(data)
# 단계 3: 계층적 군집분석
hc <- hclust(idist)
hc
# 단계 4: 군집분석 시각화
plot(hc, hang = -1)
# 단계 5: 군집 단위 테두리 생성
rect.hclust(hc, k = 6, border ="red")
# 단계 4: 군집분석 시각화
plot(hc, hang = -1)
# 단계 5: 군집 단위 테두리 생성
rect.hclust(hc, k = 4, border ="red")
# 단계 4: 군집분석 시각화
plot(hc, hang = -1)
# 단계 5: 군집 단위 테두리 생성
rect.hclust(hc, k = 4, border ="red")
# 단계 4: 군집분석 시각화
plot(hc, hang = -1)
summary(idist)
# 필요 칼럼만 호출
data <- data[c("평균운행속도", "최고속도", "급가속건수",
"급출발건수", "급감속건수",  "급정지건수",
"급좌회전건수", "급우회전건수", "급유턴건수",
"급앞지르기건수", "급진로변경건수") ]
data$평균운행속도 <- as.numeric(data$평균운행속도)
# 데이터 확인
head(data)
### 단계 2: 유클리디안 거리 계산
idist <- dist(data)
head(idist)  ## 평균이 0인 데이터에 대해 오류가 발생
# 단계 3: 계층적 군집분석
hc <- hclust(idist)
hc
# 단계 4: 군집분석 시각화
plot(hc, hang = -1)
# 단계 5: 군집 단위 테두리 생성
rect.hclust(hc, k = 4, border ="red")
summary(idist)
### 단계 3: 비계층적 군집분석
result <- kmeans(data, 3)
names(result)
str(data)
result$cluster
# 변수 간의 상관계수 보기
cor(data, method = "pearson")
### 단계 4: 군집분석 시각화
plot(result, hang = -1)
plot(data$평균운행속도, data$급가속건수   , col = result$cluster)
# 필요 칼럼만 호출
data <- data[c("급좌회전건수", "급우회전건수", "급진로변경건수") ]
## 경로 설정
getwd()
setwd("C:/Git/Data_analysis/R/프로젝트 분석")
## 군집분석(Clustering)을 위한 패키지 설치
install.packages("cluster")
install.packages("cluster")
library(cluster)
### 단계 1: 데이터셋 가져오기
data <- read.csv("상관분석R.csv", header = TRUE)
head(data)
## 필요 칼럼만 호출
# 칼럼 보기
names(data)
# 필요 칼럼만 호출
data <- data[c("급좌회전건수", "급우회전건수", "급진로변경건수") ]
data$평균운행속도 <- as.numeric(data$평균운행속도)
# 데이터 확인
head(data)
### 단계 2: 유클리디안 거리 계산
idist <- dist(data)
head(idist)  ## 평균이 0인 데이터에 대해 오류가 발생
# 단계 3: 계층적 군집분석
hc <- hclust(idist)
hc
# 단계 4: 군집분석 시각화
plot(hc, hang = -1)
# 단계 5: 군집 단위 테두리 생성
rect.hclust(hc, k = 4, border ="red")
summary(idist)
### 단계 3: 비계층적 군집분석
result <- kmeans(data, 3)
names(result)
str(data)
result$cluster
# 변수 간의 상관계수 보기
cor(data, method = "pearson")
### 단계 4: 군집분석 시각화
plot(result, hang = -1)
summary(idist)
str(data)
### 단계 4: 군집분석 시각화
plot(result, hang = -1)
plot(data$급좌회전건수, data$급우회전건수, col = result$cluster)
plot(data$급좌회전건수, data$급진로변경건수, col = result$cluster)
### 단계 5: 군집 단위 테두리 생성
rect.hclust(result, k = 2, border ="red")
plot(data$급좌회전건수, data$급진로변경건수, col = result$cluster)
plot(data$급우회전건수, data$급진로변경건수, col = result$cluster)
### 단계 4: 군집분석 시각화
plot(result, hang = 1)
### 단계 4: 군집분석 시각화
plot(result, hang = -1)
plot(data$급좌회전건수, data$급진로변경건수, col = result$cluster)
plot(data$급좌회전건수, data$급우회전건수, col = result$cluster)
plot(data$급좌회전건수, data$급진로변경건수, col = result$cluster)
plot(data$급우회전건수, data$급진로변경건수, col = result$cluster)
